#!/usr/bin/env bash

## Description: Runs NPX commands on the theme.
## Usage: npx
## Example: ddev npx

# Abort if anything fails
set -e

#-------------------------- Settings --------------------------------

# Get theme configuration from environment variables
THEME_PATH=$(printenv THEME 2>/dev/null || echo "wp-content/themes/custom/struts")

# Define full theme path
FULL_THEME_PATH="/var/www/html/web/${THEME_PATH}"

#-------------------------- Execution -------------------------------------

# Check if theme directory exists
if [ ! -d "${FULL_THEME_PATH}" ]; then
    echo "Theme directory not found: ${FULL_THEME_PATH}"
    echo "Please ensure your theme is located at the correct path or update THEME environment variable in .ddev/config.yaml"
    exit 1
fi

cd ${FULL_THEME_PATH}

npx "$@"